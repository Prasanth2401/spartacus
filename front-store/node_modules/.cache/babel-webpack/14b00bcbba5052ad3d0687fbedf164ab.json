{"ast":null,"code":"import * as i0 from '@angular/core';\nimport { Injectable, NgModule } from '@angular/core';\nimport * as i2 from '@spartacus/core';\nimport { TimeUtils, CART_NORMALIZER, ADDRESS_SERIALIZER, ADDRESS_NORMALIZER, PAYMENT_DETAILS_NORMALIZER, HttpParamsURIEncoder, REPLENISHMENT_ORDER_NORMALIZER, OCC_USER_ID_ANONYMOUS, InterceptorUtil, USE_CLIENT_TOKEN, ORDER_NORMALIZER, provideDefaultConfig } from '@spartacus/core';\nimport * as i1 from '@angular/common/http';\nimport { HttpHeaders, HttpParams } from '@angular/common/http';\nimport { DELIVERY_MODE_NORMALIZER, PAYMENT_TYPE_NORMALIZER, PAYMENT_DETAILS_SERIALIZER, CARD_TYPE_NORMALIZER, REPLENISHMENT_ORDER_FORM_SERIALIZER, CheckoutAdapter, CheckoutDeliveryAdapter, CheckoutPaymentAdapter, PaymentTypeAdapter, CheckoutCostCenterAdapter, CheckoutReplenishmentOrderAdapter } from '@spartacus/checkout/core';\nimport { pluck, map, mergeMap } from 'rxjs/operators';\nimport { CommonModule } from '@angular/common';\n\nclass OccReplenishmentOrderFormSerializer {\n  convert(source, target) {\n    if (target === undefined) {\n      target = Object.assign({}, source);\n    }\n\n    if (source.replenishmentStartDate) {\n      target.replenishmentStartDate = this.convertDate(source.replenishmentStartDate);\n    }\n\n    return target;\n  }\n  /**\n   * Adds the current timestamp (including timezone offset) to a date string in the format YYYY-mm-dd\n   * @Example\n   * Converts 2021-10-15 to 2021-10-15T15:38:05-05:00\n   */\n\n\n  convertDate(date) {\n    const localTime = new Date().toLocaleTimeString([], {\n      hour: '2-digit',\n      minute: '2-digit',\n      hourCycle: 'h23'\n    });\n    return `${date}T${localTime}:00${TimeUtils.getLocalTimezoneOffset()}`;\n  }\n\n}\n\nOccReplenishmentOrderFormSerializer.ɵfac = function OccReplenishmentOrderFormSerializer_Factory(t) {\n  return new (t || OccReplenishmentOrderFormSerializer)();\n};\n\nOccReplenishmentOrderFormSerializer.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: OccReplenishmentOrderFormSerializer,\n  factory: OccReplenishmentOrderFormSerializer.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(OccReplenishmentOrderFormSerializer, [{\n    type: Injectable\n  }], null, null);\n})();\n\nclass OccCheckoutCostCenterAdapter {\n  constructor(http, occEndpoints, converter) {\n    this.http = http;\n    this.occEndpoints = occEndpoints;\n    this.converter = converter;\n  }\n\n  setCostCenter(userId, cartId, costCenterId) {\n    return this.http.put(this.getSetCartCostCenterEndpoint(userId, cartId, costCenterId), {}).pipe(this.converter.pipeable(CART_NORMALIZER));\n  }\n\n  getSetCartCostCenterEndpoint(userId, cartId, costCenterId) {\n    return this.occEndpoints.buildUrl('setCartCostCenter', {\n      urlParams: {\n        userId,\n        cartId\n      },\n      queryParams: {\n        costCenterId\n      }\n    });\n  }\n\n}\n\nOccCheckoutCostCenterAdapter.ɵfac = function OccCheckoutCostCenterAdapter_Factory(t) {\n  return new (t || OccCheckoutCostCenterAdapter)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.OccEndpointsService), i0.ɵɵinject(i2.ConverterService));\n};\n\nOccCheckoutCostCenterAdapter.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: OccCheckoutCostCenterAdapter,\n  factory: OccCheckoutCostCenterAdapter.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(OccCheckoutCostCenterAdapter, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: i1.HttpClient\n    }, {\n      type: i2.OccEndpointsService\n    }, {\n      type: i2.ConverterService\n    }];\n  }, null);\n})();\n\nclass OccCheckoutDeliveryAdapter {\n  constructor(http, occEndpoints, converter) {\n    this.http = http;\n    this.occEndpoints = occEndpoints;\n    this.converter = converter;\n  }\n\n  getCreateDeliveryAddressEndpoint(userId, cartId) {\n    return this.occEndpoints.buildUrl('createDeliveryAddress', {\n      urlParams: {\n        userId,\n        cartId\n      }\n    });\n  }\n\n  getSetDeliveryAddressEndpoint(userId, cartId, addressId) {\n    return this.occEndpoints.buildUrl('setDeliveryAddress', {\n      urlParams: {\n        userId,\n        cartId\n      },\n      queryParams: {\n        addressId\n      }\n    });\n  }\n\n  getDeliveryModeEndpoint(userId, cartId) {\n    return this.occEndpoints.buildUrl('deliveryMode', {\n      urlParams: {\n        userId,\n        cartId\n      }\n    });\n  }\n\n  getSetDeliveryModeEndpoint(userId, cartId, deliveryModeId) {\n    return this.occEndpoints.buildUrl('setDeliveryMode', {\n      urlParams: {\n        userId,\n        cartId\n      },\n      queryParams: {\n        deliveryModeId\n      }\n    });\n  }\n\n  getDeliveryModesEndpoint(userId, cartId) {\n    return this.occEndpoints.buildUrl('deliveryModes', {\n      urlParams: {\n        userId,\n        cartId\n      }\n    });\n  }\n\n  createAddress(userId, cartId, address) {\n    address = this.converter.convert(address, ADDRESS_SERIALIZER);\n    return this.http.post(this.getCreateDeliveryAddressEndpoint(userId, cartId), address, {\n      headers: new HttpHeaders().set('Content-Type', 'application/json')\n    }).pipe(this.converter.pipeable(ADDRESS_NORMALIZER));\n  }\n\n  setAddress(userId, cartId, addressId) {\n    return this.http.put(this.getSetDeliveryAddressEndpoint(userId, cartId, addressId), {});\n  }\n\n  setMode(userId, cartId, deliveryModeId) {\n    return this.http.put(this.getSetDeliveryModeEndpoint(userId, cartId, deliveryModeId), {});\n  }\n\n  getMode(userId, cartId) {\n    return this.http.get(this.getDeliveryModeEndpoint(userId, cartId)).pipe(this.converter.pipeable(DELIVERY_MODE_NORMALIZER));\n  }\n\n  getSupportedModes(userId, cartId) {\n    return this.http.get(this.getDeliveryModesEndpoint(userId, cartId)).pipe(pluck('deliveryModes'), map(modes => modes !== null && modes !== void 0 ? modes : []), this.converter.pipeableMany(DELIVERY_MODE_NORMALIZER));\n  }\n\n}\n\nOccCheckoutDeliveryAdapter.ɵfac = function OccCheckoutDeliveryAdapter_Factory(t) {\n  return new (t || OccCheckoutDeliveryAdapter)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.OccEndpointsService), i0.ɵɵinject(i2.ConverterService));\n};\n\nOccCheckoutDeliveryAdapter.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: OccCheckoutDeliveryAdapter,\n  factory: OccCheckoutDeliveryAdapter.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(OccCheckoutDeliveryAdapter, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: i1.HttpClient\n    }, {\n      type: i2.OccEndpointsService\n    }, {\n      type: i2.ConverterService\n    }];\n  }, null);\n})();\n\nclass OccCheckoutPaymentTypeAdapter {\n  constructor(http, occEndpoints, converter) {\n    this.http = http;\n    this.occEndpoints = occEndpoints;\n    this.converter = converter;\n  }\n\n  loadPaymentTypes() {\n    return this.http.get(this.getPaymentTypesEndpoint()).pipe(map(paymentTypeList => {\n      var _a;\n\n      return (_a = paymentTypeList.paymentTypes) !== null && _a !== void 0 ? _a : [];\n    }), this.converter.pipeableMany(PAYMENT_TYPE_NORMALIZER));\n  }\n\n  setPaymentType(userId, cartId, paymentType, purchaseOrderNumber) {\n    return this.http.put(this.getSetCartPaymentTypeEndpoint(userId, cartId, paymentType, purchaseOrderNumber), {}).pipe(this.converter.pipeable(CART_NORMALIZER));\n  }\n\n  getPaymentTypesEndpoint() {\n    return this.occEndpoints.buildUrl('paymentTypes');\n  }\n\n  getSetCartPaymentTypeEndpoint(userId, cartId, paymentType, purchaseOrderNumber) {\n    const queryParams = purchaseOrderNumber ? {\n      paymentType,\n      purchaseOrderNumber\n    } : {\n      paymentType\n    };\n    return this.occEndpoints.buildUrl('setCartPaymentType', {\n      urlParams: {\n        userId,\n        cartId\n      },\n      queryParams\n    });\n  }\n\n}\n\nOccCheckoutPaymentTypeAdapter.ɵfac = function OccCheckoutPaymentTypeAdapter_Factory(t) {\n  return new (t || OccCheckoutPaymentTypeAdapter)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.OccEndpointsService), i0.ɵɵinject(i2.ConverterService));\n};\n\nOccCheckoutPaymentTypeAdapter.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: OccCheckoutPaymentTypeAdapter,\n  factory: OccCheckoutPaymentTypeAdapter.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(OccCheckoutPaymentTypeAdapter, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: i1.HttpClient\n    }, {\n      type: i2.OccEndpointsService\n    }, {\n      type: i2.ConverterService\n    }];\n  }, null);\n})();\n\nclass OccCheckoutPaymentAdapter {\n  constructor(http, occEndpoints, converter) {\n    this.http = http;\n    this.occEndpoints = occEndpoints;\n    this.converter = converter;\n\n    if (typeof DOMParser !== 'undefined') {\n      this.domparser = new DOMParser();\n    }\n  }\n\n  getSetPaymentDetailsEndpoint(userId, cartId, paymentDetailsId) {\n    return this.occEndpoints.buildUrl('setCartPaymentDetails', {\n      urlParams: {\n        userId,\n        cartId\n      },\n      queryParams: {\n        paymentDetailsId\n      }\n    });\n  }\n\n  getPaymentProviderSubInfoEndpoint(userId, cartId) {\n    return this.occEndpoints.buildUrl('paymentProviderSubInfo', {\n      urlParams: {\n        userId,\n        cartId\n      }\n    });\n  }\n\n  getCreatePaymentDetailsEndpoint(userId, cartId) {\n    return this.occEndpoints.buildUrl('createPaymentDetails', {\n      urlParams: {\n        userId,\n        cartId\n      }\n    });\n  }\n\n  getCardTypesEndpoint() {\n    return this.occEndpoints.buildUrl('cardTypes');\n  }\n\n  create(userId, cartId, paymentDetails) {\n    paymentDetails = this.converter.convert(paymentDetails, PAYMENT_DETAILS_SERIALIZER);\n    return this.getProviderSubInfo(userId, cartId).pipe(map(data => {\n      const labelsMap = this.convertToMap(data.mappingLabels.entry);\n      return {\n        url: data.postUrl,\n        parameters: this.getParamsForPaymentProvider(paymentDetails, data.parameters.entry, labelsMap),\n        mappingLabels: labelsMap\n      };\n    }), mergeMap(sub => {\n      // create a subscription directly with payment provider\n      return this.createSubWithProvider(sub.url, sub.parameters).pipe(map(response => this.extractPaymentDetailsFromHtml(response)), mergeMap(fromPaymentProvider => {\n        var _a;\n\n        fromPaymentProvider['defaultPayment'] = (_a = paymentDetails.defaultPayment) !== null && _a !== void 0 ? _a : false;\n        fromPaymentProvider['savePaymentInfo'] = true;\n        return this.createDetailsWithParameters(userId, cartId, fromPaymentProvider).pipe(this.converter.pipeable(PAYMENT_DETAILS_NORMALIZER));\n      }));\n    }));\n  }\n\n  set(userId, cartId, paymentDetailsId) {\n    return this.http.put(this.getSetPaymentDetailsEndpoint(userId, cartId, paymentDetailsId), {});\n  }\n\n  loadCardTypes() {\n    return this.http.get(this.getCardTypesEndpoint()).pipe(map(cardTypeList => {\n      var _a;\n\n      return (_a = cardTypeList.cardTypes) !== null && _a !== void 0 ? _a : [];\n    }), this.converter.pipeableMany(CARD_TYPE_NORMALIZER));\n  }\n\n  getProviderSubInfo(userId, cartId) {\n    return this.http.get(this.getPaymentProviderSubInfoEndpoint(userId, cartId));\n  }\n\n  createSubWithProvider(postUrl, parameters) {\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded',\n      Accept: 'text/html'\n    });\n    let httpParams = new HttpParams({\n      encoder: new HttpParamsURIEncoder()\n    });\n    Object.keys(parameters).forEach(key => {\n      httpParams = httpParams.append(key, parameters[key]);\n    });\n    return this.http.post(postUrl, httpParams, {\n      headers,\n      responseType: 'text'\n    });\n  }\n\n  createDetailsWithParameters(userId, cartId, parameters) {\n    let httpParams = new HttpParams({\n      encoder: new HttpParamsURIEncoder()\n    });\n    Object.keys(parameters).forEach(key => {\n      httpParams = httpParams.append(key, parameters[key]);\n    });\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded'\n    });\n    return this.http.post(this.getCreatePaymentDetailsEndpoint(userId, cartId), httpParams, {\n      headers\n    });\n  }\n\n  getParamsForPaymentProvider(paymentDetails, parameters, mappingLabels) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\n\n    const params = this.convertToMap(parameters);\n    params[mappingLabels['hybris_account_holder_name']] = paymentDetails.accountHolderName;\n    params[mappingLabels['hybris_card_type']] = (_a = paymentDetails.cardType) === null || _a === void 0 ? void 0 : _a.code;\n    params[mappingLabels['hybris_card_number']] = paymentDetails.cardNumber;\n\n    if (mappingLabels['hybris_combined_expiry_date'] === 'true') {\n      params[mappingLabels['hybris_card_expiry_date']] = paymentDetails.expiryMonth + mappingLabels['hybris_separator_expiry_date'] + paymentDetails.expiryYear;\n    } else {\n      params[mappingLabels['hybris_card_expiration_month']] = paymentDetails.expiryMonth;\n      params[mappingLabels['hybris_card_expiration_year']] = paymentDetails.expiryYear;\n    }\n\n    params[mappingLabels['hybris_card_cvn']] = paymentDetails.cvn; // billing address\n\n    params[mappingLabels['hybris_billTo_country']] = (_c = (_b = paymentDetails.billingAddress) === null || _b === void 0 ? void 0 : _b.country) === null || _c === void 0 ? void 0 : _c.isocode;\n    params[mappingLabels['hybris_billTo_firstname']] = (_d = paymentDetails.billingAddress) === null || _d === void 0 ? void 0 : _d.firstName;\n    params[mappingLabels['hybris_billTo_lastname']] = (_e = paymentDetails.billingAddress) === null || _e === void 0 ? void 0 : _e.lastName;\n    params[mappingLabels['hybris_billTo_street1']] = ((_f = paymentDetails.billingAddress) === null || _f === void 0 ? void 0 : _f.line1) + ' ' + ((_g = paymentDetails.billingAddress) === null || _g === void 0 ? void 0 : _g.line2);\n    params[mappingLabels['hybris_billTo_city']] = (_h = paymentDetails.billingAddress) === null || _h === void 0 ? void 0 : _h.town;\n\n    if ((_j = paymentDetails.billingAddress) === null || _j === void 0 ? void 0 : _j.region) {\n      params[mappingLabels['hybris_billTo_region']] = paymentDetails.billingAddress.region.isocodeShort;\n    } else {\n      params[mappingLabels['hybris_billTo_region']] = '';\n    }\n\n    params[mappingLabels['hybris_billTo_postalcode']] = (_k = paymentDetails.billingAddress) === null || _k === void 0 ? void 0 : _k.postalCode;\n    return params;\n  }\n\n  extractPaymentDetailsFromHtml(html) {\n    const domdoc = this.domparser.parseFromString(html, 'text/xml');\n    const responseForm = domdoc.getElementsByTagName('form')[0];\n    const inputs = responseForm.getElementsByTagName('input');\n    const values = {};\n\n    for (let i = 0; inputs[i]; i++) {\n      const input = inputs[i];\n      const name = input.getAttribute('name');\n      const value = input.getAttribute('value');\n\n      if (name && name !== '{}' && value && value !== '') {\n        values[name] = value;\n      }\n    }\n\n    return values;\n  }\n\n  convertToMap(paramList) {\n    return paramList.reduce(function (result, item) {\n      const key = item.key;\n      result[key] = item.value;\n      return result;\n    }, {});\n  }\n\n}\n\nOccCheckoutPaymentAdapter.ɵfac = function OccCheckoutPaymentAdapter_Factory(t) {\n  return new (t || OccCheckoutPaymentAdapter)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.OccEndpointsService), i0.ɵɵinject(i2.ConverterService));\n};\n\nOccCheckoutPaymentAdapter.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: OccCheckoutPaymentAdapter,\n  factory: OccCheckoutPaymentAdapter.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(OccCheckoutPaymentAdapter, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: i1.HttpClient\n    }, {\n      type: i2.OccEndpointsService\n    }, {\n      type: i2.ConverterService\n    }];\n  }, null);\n})();\n\nclass OccCheckoutReplenishmentOrderAdapter {\n  constructor(http, occEndpoints, converter) {\n    this.http = http;\n    this.occEndpoints = occEndpoints;\n    this.converter = converter;\n  }\n\n  getScheduleReplenishmentOrderEndpoint(userId, cartId, termsChecked) {\n    return this.occEndpoints.buildUrl('scheduleReplenishmentOrder', {\n      urlParams: {\n        userId\n      },\n      queryParams: {\n        cartId,\n        termsChecked\n      }\n    });\n  }\n\n  scheduleReplenishmentOrder(cartId, scheduleReplenishmentForm, termsChecked, userId) {\n    scheduleReplenishmentForm = this.converter.convert(scheduleReplenishmentForm, REPLENISHMENT_ORDER_FORM_SERIALIZER);\n    const headers = new HttpHeaders().set('Content-Type', 'application/json');\n    return this.http.post(this.getScheduleReplenishmentOrderEndpoint(userId, cartId, termsChecked.toString()), scheduleReplenishmentForm, {\n      headers\n    }).pipe(this.converter.pipeable(REPLENISHMENT_ORDER_NORMALIZER));\n  }\n\n}\n\nOccCheckoutReplenishmentOrderAdapter.ɵfac = function OccCheckoutReplenishmentOrderAdapter_Factory(t) {\n  return new (t || OccCheckoutReplenishmentOrderAdapter)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.OccEndpointsService), i0.ɵɵinject(i2.ConverterService));\n};\n\nOccCheckoutReplenishmentOrderAdapter.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: OccCheckoutReplenishmentOrderAdapter,\n  factory: OccCheckoutReplenishmentOrderAdapter.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(OccCheckoutReplenishmentOrderAdapter, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: i1.HttpClient\n    }, {\n      type: i2.OccEndpointsService\n    }, {\n      type: i2.ConverterService\n    }];\n  }, null);\n})();\n\nclass OccCheckoutAdapter {\n  constructor(http, occEndpoints, converter) {\n    this.http = http;\n    this.occEndpoints = occEndpoints;\n    this.converter = converter;\n  }\n\n  getPlaceOrderEndpoint(userId, cartId, termsChecked) {\n    return this.occEndpoints.buildUrl('placeOrder', {\n      urlParams: {\n        userId\n      },\n      queryParams: {\n        cartId,\n        termsChecked\n      }\n    });\n  }\n\n  getRemoveDeliveryAddressEndpoint(userId, cartId) {\n    return this.occEndpoints.buildUrl('removeDeliveryAddress', {\n      urlParams: {\n        userId,\n        cartId\n      }\n    });\n  }\n\n  getClearDeliveryModeEndpoint(userId, cartId) {\n    return this.occEndpoints.buildUrl('clearDeliveryMode', {\n      urlParams: {\n        userId,\n        cartId\n      }\n    });\n  }\n\n  getLoadCheckoutDetailsEndpoint(userId, cartId) {\n    return this.occEndpoints.buildUrl('loadCheckoutDetails', {\n      urlParams: {\n        userId,\n        cartId\n      }\n    });\n  }\n\n  placeOrder(userId, cartId, termsChecked) {\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded'\n    });\n\n    if (userId === OCC_USER_ID_ANONYMOUS) {\n      headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    }\n\n    return this.http.post(this.getPlaceOrderEndpoint(userId, cartId, termsChecked.toString()), {}, {\n      headers\n    }).pipe(this.converter.pipeable(ORDER_NORMALIZER));\n  }\n\n  loadCheckoutDetails(userId, cartId) {\n    return this.http.get(this.getLoadCheckoutDetailsEndpoint(userId, cartId));\n  }\n\n  clearCheckoutDeliveryAddress(userId, cartId) {\n    return this.http.delete(this.getRemoveDeliveryAddressEndpoint(userId, cartId));\n  }\n\n  clearCheckoutDeliveryMode(userId, cartId) {\n    return this.http.delete(this.getClearDeliveryModeEndpoint(userId, cartId));\n  }\n\n}\n\nOccCheckoutAdapter.ɵfac = function OccCheckoutAdapter_Factory(t) {\n  return new (t || OccCheckoutAdapter)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.OccEndpointsService), i0.ɵɵinject(i2.ConverterService));\n};\n\nOccCheckoutAdapter.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: OccCheckoutAdapter,\n  factory: OccCheckoutAdapter.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(OccCheckoutAdapter, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: i1.HttpClient\n    }, {\n      type: i2.OccEndpointsService\n    }, {\n      type: i2.ConverterService\n    }];\n  }, null);\n})();\n\nconst defaultOccCheckoutConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        /* eslint-disable max-len */\n        setDeliveryAddress: 'users/${userId}/carts/${cartId}/addresses/delivery',\n        placeOrder: 'users/${userId}/orders?fields=FULL',\n        cardTypes: 'cardtypes',\n        paymentTypes: 'paymenttypes',\n        createDeliveryAddress: 'users/${userId}/carts/${cartId}/addresses/delivery',\n        removeDeliveryAddress: 'users/${userId}/carts/${cartId}/addresses/delivery',\n        deliveryMode: 'users/${userId}/carts/${cartId}/deliverymode',\n        setDeliveryMode: 'users/${userId}/carts/${cartId}/deliverymode',\n        clearDeliveryMode: 'users/${userId}/carts/${cartId}/deliverymode',\n        deliveryModes: 'users/${userId}/carts/${cartId}/deliverymodes',\n        setCartCostCenter: 'users/${userId}/carts/${cartId}/costcenter?fields=DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),user',\n        setCartPaymentType: 'users/${userId}/carts/${cartId}/paymenttype?fields=DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),user',\n        setCartPaymentDetails: 'users/${userId}/carts/${cartId}/paymentdetails',\n        paymentProviderSubInfo: 'users/${userId}/carts/${cartId}/payment/sop/request?responseUrl=sampleUrl',\n        createPaymentDetails: 'users/${userId}/carts/${cartId}/payment/sop/response',\n        loadCheckoutDetails: 'users/${userId}/carts/${cartId}?fields=deliveryAddress(FULL),deliveryMode,paymentInfo(FULL)'\n        /* eslint-enable */\n\n      }\n    }\n  }\n};\n\nclass CheckoutOccModule {}\n\nCheckoutOccModule.ɵfac = function CheckoutOccModule_Factory(t) {\n  return new (t || CheckoutOccModule)();\n};\n\nCheckoutOccModule.ɵmod = /* @__PURE__ */i0.ɵɵdefineNgModule({\n  type: CheckoutOccModule\n});\nCheckoutOccModule.ɵinj = /* @__PURE__ */i0.ɵɵdefineInjector({\n  providers: [provideDefaultConfig(defaultOccCheckoutConfig), OccReplenishmentOrderFormSerializer, {\n    provide: CheckoutAdapter,\n    useClass: OccCheckoutAdapter\n  }, {\n    provide: CheckoutDeliveryAdapter,\n    useClass: OccCheckoutDeliveryAdapter\n  }, {\n    provide: CheckoutPaymentAdapter,\n    useClass: OccCheckoutPaymentAdapter\n  }, {\n    provide: PaymentTypeAdapter,\n    useClass: OccCheckoutPaymentTypeAdapter\n  }, {\n    provide: CheckoutCostCenterAdapter,\n    useClass: OccCheckoutCostCenterAdapter\n  }, {\n    provide: CheckoutReplenishmentOrderAdapter,\n    useClass: OccCheckoutReplenishmentOrderAdapter\n  }, {\n    provide: REPLENISHMENT_ORDER_FORM_SERIALIZER,\n    useExisting: OccReplenishmentOrderFormSerializer,\n    multi: true\n  }],\n  imports: [[CommonModule]]\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(CheckoutOccModule, [{\n    type: NgModule,\n    args: [{\n      imports: [CommonModule],\n      providers: [provideDefaultConfig(defaultOccCheckoutConfig), OccReplenishmentOrderFormSerializer, {\n        provide: CheckoutAdapter,\n        useClass: OccCheckoutAdapter\n      }, {\n        provide: CheckoutDeliveryAdapter,\n        useClass: OccCheckoutDeliveryAdapter\n      }, {\n        provide: CheckoutPaymentAdapter,\n        useClass: OccCheckoutPaymentAdapter\n      }, {\n        provide: PaymentTypeAdapter,\n        useClass: OccCheckoutPaymentTypeAdapter\n      }, {\n        provide: CheckoutCostCenterAdapter,\n        useClass: OccCheckoutCostCenterAdapter\n      }, {\n        provide: CheckoutReplenishmentOrderAdapter,\n        useClass: OccCheckoutReplenishmentOrderAdapter\n      }, {\n        provide: REPLENISHMENT_ORDER_FORM_SERIALIZER,\n        useExisting: OccReplenishmentOrderFormSerializer,\n        multi: true\n      }]\n    }]\n  }], null, null);\n})();\n/**\n * Generated bundle index. Do not edit.\n */\n\n\nexport { CheckoutOccModule, OccCheckoutAdapter, OccCheckoutCostCenterAdapter, OccCheckoutDeliveryAdapter, OccCheckoutPaymentAdapter, OccCheckoutPaymentTypeAdapter, OccCheckoutReplenishmentOrderAdapter, OccReplenishmentOrderFormSerializer }; //# sourceMappingURL=spartacus-checkout-occ.js.map","map":{"version":3,"sources":["D:/spartacus/front-store/node_modules/@spartacus/checkout/fesm2015/spartacus-checkout-occ.js"],"names":["i0","Injectable","NgModule","i2","TimeUtils","CART_NORMALIZER","ADDRESS_SERIALIZER","ADDRESS_NORMALIZER","PAYMENT_DETAILS_NORMALIZER","HttpParamsURIEncoder","REPLENISHMENT_ORDER_NORMALIZER","OCC_USER_ID_ANONYMOUS","InterceptorUtil","USE_CLIENT_TOKEN","ORDER_NORMALIZER","provideDefaultConfig","i1","HttpHeaders","HttpParams","DELIVERY_MODE_NORMALIZER","PAYMENT_TYPE_NORMALIZER","PAYMENT_DETAILS_SERIALIZER","CARD_TYPE_NORMALIZER","REPLENISHMENT_ORDER_FORM_SERIALIZER","CheckoutAdapter","CheckoutDeliveryAdapter","CheckoutPaymentAdapter","PaymentTypeAdapter","CheckoutCostCenterAdapter","CheckoutReplenishmentOrderAdapter","pluck","map","mergeMap","CommonModule","OccReplenishmentOrderFormSerializer","convert","source","target","undefined","Object","assign","replenishmentStartDate","convertDate","date","localTime","Date","toLocaleTimeString","hour","minute","hourCycle","getLocalTimezoneOffset","ɵfac","ɵprov","type","OccCheckoutCostCenterAdapter","constructor","http","occEndpoints","converter","setCostCenter","userId","cartId","costCenterId","put","getSetCartCostCenterEndpoint","pipe","pipeable","buildUrl","urlParams","queryParams","HttpClient","OccEndpointsService","ConverterService","OccCheckoutDeliveryAdapter","getCreateDeliveryAddressEndpoint","getSetDeliveryAddressEndpoint","addressId","getDeliveryModeEndpoint","getSetDeliveryModeEndpoint","deliveryModeId","getDeliveryModesEndpoint","createAddress","address","post","headers","set","setAddress","setMode","getMode","get","getSupportedModes","modes","pipeableMany","OccCheckoutPaymentTypeAdapter","loadPaymentTypes","getPaymentTypesEndpoint","paymentTypeList","_a","paymentTypes","setPaymentType","paymentType","purchaseOrderNumber","getSetCartPaymentTypeEndpoint","OccCheckoutPaymentAdapter","DOMParser","domparser","getSetPaymentDetailsEndpoint","paymentDetailsId","getPaymentProviderSubInfoEndpoint","getCreatePaymentDetailsEndpoint","getCardTypesEndpoint","create","paymentDetails","getProviderSubInfo","data","labelsMap","convertToMap","mappingLabels","entry","url","postUrl","parameters","getParamsForPaymentProvider","sub","createSubWithProvider","response","extractPaymentDetailsFromHtml","fromPaymentProvider","defaultPayment","createDetailsWithParameters","loadCardTypes","cardTypeList","cardTypes","Accept","httpParams","encoder","keys","forEach","key","append","responseType","_b","_c","_d","_e","_f","_g","_h","_j","_k","params","accountHolderName","cardType","code","cardNumber","expiryMonth","expiryYear","cvn","billingAddress","country","isocode","firstName","lastName","line1","line2","town","region","isocodeShort","postalCode","html","domdoc","parseFromString","responseForm","getElementsByTagName","inputs","values","i","input","name","getAttribute","value","paramList","reduce","result","item","OccCheckoutReplenishmentOrderAdapter","getScheduleReplenishmentOrderEndpoint","termsChecked","scheduleReplenishmentOrder","scheduleReplenishmentForm","toString","OccCheckoutAdapter","getPlaceOrderEndpoint","getRemoveDeliveryAddressEndpoint","getClearDeliveryModeEndpoint","getLoadCheckoutDetailsEndpoint","placeOrder","createHeader","loadCheckoutDetails","clearCheckoutDeliveryAddress","delete","clearCheckoutDeliveryMode","defaultOccCheckoutConfig","backend","occ","endpoints","setDeliveryAddress","createDeliveryAddress","removeDeliveryAddress","deliveryMode","setDeliveryMode","clearDeliveryMode","deliveryModes","setCartCostCenter","setCartPaymentType","setCartPaymentDetails","paymentProviderSubInfo","createPaymentDetails","CheckoutOccModule","ɵmod","ɵinj","provide","useClass","useExisting","multi","args","imports","providers"],"mappings":"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","sourcesContent":["import * as i0 from '@angular/core';\nimport { Injectable, NgModule } from '@angular/core';\nimport * as i2 from '@spartacus/core';\nimport { TimeUtils, CART_NORMALIZER, ADDRESS_SERIALIZER, ADDRESS_NORMALIZER, PAYMENT_DETAILS_NORMALIZER, HttpParamsURIEncoder, REPLENISHMENT_ORDER_NORMALIZER, OCC_USER_ID_ANONYMOUS, InterceptorUtil, USE_CLIENT_TOKEN, ORDER_NORMALIZER, provideDefaultConfig } from '@spartacus/core';\nimport * as i1 from '@angular/common/http';\nimport { HttpHeaders, HttpParams } from '@angular/common/http';\nimport { DELIVERY_MODE_NORMALIZER, PAYMENT_TYPE_NORMALIZER, PAYMENT_DETAILS_SERIALIZER, CARD_TYPE_NORMALIZER, REPLENISHMENT_ORDER_FORM_SERIALIZER, CheckoutAdapter, CheckoutDeliveryAdapter, CheckoutPaymentAdapter, PaymentTypeAdapter, CheckoutCostCenterAdapter, CheckoutReplenishmentOrderAdapter } from '@spartacus/checkout/core';\nimport { pluck, map, mergeMap } from 'rxjs/operators';\nimport { CommonModule } from '@angular/common';\n\nclass OccReplenishmentOrderFormSerializer {\n    convert(source, target) {\n        if (target === undefined) {\n            target = Object.assign({}, source);\n        }\n        if (source.replenishmentStartDate) {\n            target.replenishmentStartDate = this.convertDate(source.replenishmentStartDate);\n        }\n        return target;\n    }\n    /**\n     * Adds the current timestamp (including timezone offset) to a date string in the format YYYY-mm-dd\n     * @Example\n     * Converts 2021-10-15 to 2021-10-15T15:38:05-05:00\n     */\n    convertDate(date) {\n        const localTime = new Date().toLocaleTimeString([], {\n            hour: '2-digit',\n            minute: '2-digit',\n            hourCycle: 'h23',\n        });\n        return `${date}T${localTime}:00${TimeUtils.getLocalTimezoneOffset()}`;\n    }\n}\nOccReplenishmentOrderFormSerializer.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccReplenishmentOrderFormSerializer, deps: [], target: i0.ɵɵFactoryTarget.Injectable });\nOccReplenishmentOrderFormSerializer.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccReplenishmentOrderFormSerializer });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccReplenishmentOrderFormSerializer, decorators: [{\n            type: Injectable\n        }] });\n\nclass OccCheckoutCostCenterAdapter {\n    constructor(http, occEndpoints, converter) {\n        this.http = http;\n        this.occEndpoints = occEndpoints;\n        this.converter = converter;\n    }\n    setCostCenter(userId, cartId, costCenterId) {\n        return this.http\n            .put(this.getSetCartCostCenterEndpoint(userId, cartId, costCenterId), {})\n            .pipe(this.converter.pipeable(CART_NORMALIZER));\n    }\n    getSetCartCostCenterEndpoint(userId, cartId, costCenterId) {\n        return this.occEndpoints.buildUrl('setCartCostCenter', {\n            urlParams: { userId, cartId },\n            queryParams: { costCenterId },\n        });\n    }\n}\nOccCheckoutCostCenterAdapter.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutCostCenterAdapter, deps: [{ token: i1.HttpClient }, { token: i2.OccEndpointsService }, { token: i2.ConverterService }], target: i0.ɵɵFactoryTarget.Injectable });\nOccCheckoutCostCenterAdapter.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutCostCenterAdapter });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutCostCenterAdapter, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: i1.HttpClient }, { type: i2.OccEndpointsService }, { type: i2.ConverterService }]; } });\n\nclass OccCheckoutDeliveryAdapter {\n    constructor(http, occEndpoints, converter) {\n        this.http = http;\n        this.occEndpoints = occEndpoints;\n        this.converter = converter;\n    }\n    getCreateDeliveryAddressEndpoint(userId, cartId) {\n        return this.occEndpoints.buildUrl('createDeliveryAddress', {\n            urlParams: {\n                userId,\n                cartId,\n            },\n        });\n    }\n    getSetDeliveryAddressEndpoint(userId, cartId, addressId) {\n        return this.occEndpoints.buildUrl('setDeliveryAddress', {\n            urlParams: { userId, cartId },\n            queryParams: { addressId },\n        });\n    }\n    getDeliveryModeEndpoint(userId, cartId) {\n        return this.occEndpoints.buildUrl('deliveryMode', {\n            urlParams: {\n                userId,\n                cartId,\n            },\n        });\n    }\n    getSetDeliveryModeEndpoint(userId, cartId, deliveryModeId) {\n        return this.occEndpoints.buildUrl('setDeliveryMode', {\n            urlParams: {\n                userId,\n                cartId,\n            },\n            queryParams: { deliveryModeId },\n        });\n    }\n    getDeliveryModesEndpoint(userId, cartId) {\n        return this.occEndpoints.buildUrl('deliveryModes', {\n            urlParams: { userId, cartId },\n        });\n    }\n    createAddress(userId, cartId, address) {\n        address = this.converter.convert(address, ADDRESS_SERIALIZER);\n        return this.http\n            .post(this.getCreateDeliveryAddressEndpoint(userId, cartId), address, {\n            headers: new HttpHeaders().set('Content-Type', 'application/json'),\n        })\n            .pipe(this.converter.pipeable(ADDRESS_NORMALIZER));\n    }\n    setAddress(userId, cartId, addressId) {\n        return this.http.put(this.getSetDeliveryAddressEndpoint(userId, cartId, addressId), {});\n    }\n    setMode(userId, cartId, deliveryModeId) {\n        return this.http.put(this.getSetDeliveryModeEndpoint(userId, cartId, deliveryModeId), {});\n    }\n    getMode(userId, cartId) {\n        return this.http\n            .get(this.getDeliveryModeEndpoint(userId, cartId))\n            .pipe(this.converter.pipeable(DELIVERY_MODE_NORMALIZER));\n    }\n    getSupportedModes(userId, cartId) {\n        return this.http\n            .get(this.getDeliveryModesEndpoint(userId, cartId))\n            .pipe(pluck('deliveryModes'), map((modes) => modes !== null && modes !== void 0 ? modes : []), this.converter.pipeableMany(DELIVERY_MODE_NORMALIZER));\n    }\n}\nOccCheckoutDeliveryAdapter.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutDeliveryAdapter, deps: [{ token: i1.HttpClient }, { token: i2.OccEndpointsService }, { token: i2.ConverterService }], target: i0.ɵɵFactoryTarget.Injectable });\nOccCheckoutDeliveryAdapter.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutDeliveryAdapter });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutDeliveryAdapter, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: i1.HttpClient }, { type: i2.OccEndpointsService }, { type: i2.ConverterService }]; } });\n\nclass OccCheckoutPaymentTypeAdapter {\n    constructor(http, occEndpoints, converter) {\n        this.http = http;\n        this.occEndpoints = occEndpoints;\n        this.converter = converter;\n    }\n    loadPaymentTypes() {\n        return this.http\n            .get(this.getPaymentTypesEndpoint())\n            .pipe(map((paymentTypeList) => { var _a; return (_a = paymentTypeList.paymentTypes) !== null && _a !== void 0 ? _a : []; }), this.converter.pipeableMany(PAYMENT_TYPE_NORMALIZER));\n    }\n    setPaymentType(userId, cartId, paymentType, purchaseOrderNumber) {\n        return this.http\n            .put(this.getSetCartPaymentTypeEndpoint(userId, cartId, paymentType, purchaseOrderNumber), {})\n            .pipe(this.converter.pipeable(CART_NORMALIZER));\n    }\n    getPaymentTypesEndpoint() {\n        return this.occEndpoints.buildUrl('paymentTypes');\n    }\n    getSetCartPaymentTypeEndpoint(userId, cartId, paymentType, purchaseOrderNumber) {\n        const queryParams = purchaseOrderNumber\n            ? { paymentType, purchaseOrderNumber }\n            : { paymentType };\n        return this.occEndpoints.buildUrl('setCartPaymentType', {\n            urlParams: { userId, cartId },\n            queryParams,\n        });\n    }\n}\nOccCheckoutPaymentTypeAdapter.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutPaymentTypeAdapter, deps: [{ token: i1.HttpClient }, { token: i2.OccEndpointsService }, { token: i2.ConverterService }], target: i0.ɵɵFactoryTarget.Injectable });\nOccCheckoutPaymentTypeAdapter.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutPaymentTypeAdapter });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutPaymentTypeAdapter, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: i1.HttpClient }, { type: i2.OccEndpointsService }, { type: i2.ConverterService }]; } });\n\nclass OccCheckoutPaymentAdapter {\n    constructor(http, occEndpoints, converter) {\n        this.http = http;\n        this.occEndpoints = occEndpoints;\n        this.converter = converter;\n        if (typeof DOMParser !== 'undefined') {\n            this.domparser = new DOMParser();\n        }\n    }\n    getSetPaymentDetailsEndpoint(userId, cartId, paymentDetailsId) {\n        return this.occEndpoints.buildUrl('setCartPaymentDetails', {\n            urlParams: { userId, cartId },\n            queryParams: { paymentDetailsId },\n        });\n    }\n    getPaymentProviderSubInfoEndpoint(userId, cartId) {\n        return this.occEndpoints.buildUrl('paymentProviderSubInfo', {\n            urlParams: {\n                userId,\n                cartId,\n            },\n        });\n    }\n    getCreatePaymentDetailsEndpoint(userId, cartId) {\n        return this.occEndpoints.buildUrl('createPaymentDetails', {\n            urlParams: {\n                userId,\n                cartId,\n            },\n        });\n    }\n    getCardTypesEndpoint() {\n        return this.occEndpoints.buildUrl('cardTypes');\n    }\n    create(userId, cartId, paymentDetails) {\n        paymentDetails = this.converter.convert(paymentDetails, PAYMENT_DETAILS_SERIALIZER);\n        return this.getProviderSubInfo(userId, cartId).pipe(map((data) => {\n            const labelsMap = this.convertToMap(data.mappingLabels.entry);\n            return {\n                url: data.postUrl,\n                parameters: this.getParamsForPaymentProvider(paymentDetails, data.parameters.entry, labelsMap),\n                mappingLabels: labelsMap,\n            };\n        }), mergeMap((sub) => {\n            // create a subscription directly with payment provider\n            return this.createSubWithProvider(sub.url, sub.parameters).pipe(map((response) => this.extractPaymentDetailsFromHtml(response)), mergeMap((fromPaymentProvider) => {\n                var _a;\n                fromPaymentProvider['defaultPayment'] =\n                    (_a = paymentDetails.defaultPayment) !== null && _a !== void 0 ? _a : false;\n                fromPaymentProvider['savePaymentInfo'] = true;\n                return this.createDetailsWithParameters(userId, cartId, fromPaymentProvider).pipe(this.converter.pipeable(PAYMENT_DETAILS_NORMALIZER));\n            }));\n        }));\n    }\n    set(userId, cartId, paymentDetailsId) {\n        return this.http.put(this.getSetPaymentDetailsEndpoint(userId, cartId, paymentDetailsId), {});\n    }\n    loadCardTypes() {\n        return this.http.get(this.getCardTypesEndpoint()).pipe(map((cardTypeList) => { var _a; return (_a = cardTypeList.cardTypes) !== null && _a !== void 0 ? _a : []; }), this.converter.pipeableMany(CARD_TYPE_NORMALIZER));\n    }\n    getProviderSubInfo(userId, cartId) {\n        return this.http.get(this.getPaymentProviderSubInfoEndpoint(userId, cartId));\n    }\n    createSubWithProvider(postUrl, parameters) {\n        const headers = new HttpHeaders({\n            'Content-Type': 'application/x-www-form-urlencoded',\n            Accept: 'text/html',\n        });\n        let httpParams = new HttpParams({ encoder: new HttpParamsURIEncoder() });\n        Object.keys(parameters).forEach((key) => {\n            httpParams = httpParams.append(key, parameters[key]);\n        });\n        return this.http.post(postUrl, httpParams, {\n            headers,\n            responseType: 'text',\n        });\n    }\n    createDetailsWithParameters(userId, cartId, parameters) {\n        let httpParams = new HttpParams({ encoder: new HttpParamsURIEncoder() });\n        Object.keys(parameters).forEach((key) => {\n            httpParams = httpParams.append(key, parameters[key]);\n        });\n        const headers = new HttpHeaders({\n            'Content-Type': 'application/x-www-form-urlencoded',\n        });\n        return this.http.post(this.getCreatePaymentDetailsEndpoint(userId, cartId), httpParams, { headers });\n    }\n    getParamsForPaymentProvider(paymentDetails, parameters, mappingLabels) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\n        const params = this.convertToMap(parameters);\n        params[mappingLabels['hybris_account_holder_name']] =\n            paymentDetails.accountHolderName;\n        params[mappingLabels['hybris_card_type']] = (_a = paymentDetails.cardType) === null || _a === void 0 ? void 0 : _a.code;\n        params[mappingLabels['hybris_card_number']] = paymentDetails.cardNumber;\n        if (mappingLabels['hybris_combined_expiry_date'] === 'true') {\n            params[mappingLabels['hybris_card_expiry_date']] =\n                paymentDetails.expiryMonth +\n                    mappingLabels['hybris_separator_expiry_date'] +\n                    paymentDetails.expiryYear;\n        }\n        else {\n            params[mappingLabels['hybris_card_expiration_month']] =\n                paymentDetails.expiryMonth;\n            params[mappingLabels['hybris_card_expiration_year']] =\n                paymentDetails.expiryYear;\n        }\n        params[mappingLabels['hybris_card_cvn']] = paymentDetails.cvn;\n        // billing address\n        params[mappingLabels['hybris_billTo_country']] =\n            (_c = (_b = paymentDetails.billingAddress) === null || _b === void 0 ? void 0 : _b.country) === null || _c === void 0 ? void 0 : _c.isocode;\n        params[mappingLabels['hybris_billTo_firstname']] =\n            (_d = paymentDetails.billingAddress) === null || _d === void 0 ? void 0 : _d.firstName;\n        params[mappingLabels['hybris_billTo_lastname']] =\n            (_e = paymentDetails.billingAddress) === null || _e === void 0 ? void 0 : _e.lastName;\n        params[mappingLabels['hybris_billTo_street1']] =\n            ((_f = paymentDetails.billingAddress) === null || _f === void 0 ? void 0 : _f.line1) +\n                ' ' +\n                ((_g = paymentDetails.billingAddress) === null || _g === void 0 ? void 0 : _g.line2);\n        params[mappingLabels['hybris_billTo_city']] =\n            (_h = paymentDetails.billingAddress) === null || _h === void 0 ? void 0 : _h.town;\n        if ((_j = paymentDetails.billingAddress) === null || _j === void 0 ? void 0 : _j.region) {\n            params[mappingLabels['hybris_billTo_region']] =\n                paymentDetails.billingAddress.region.isocodeShort;\n        }\n        else {\n            params[mappingLabels['hybris_billTo_region']] = '';\n        }\n        params[mappingLabels['hybris_billTo_postalcode']] =\n            (_k = paymentDetails.billingAddress) === null || _k === void 0 ? void 0 : _k.postalCode;\n        return params;\n    }\n    extractPaymentDetailsFromHtml(html) {\n        const domdoc = this.domparser.parseFromString(html, 'text/xml');\n        const responseForm = domdoc.getElementsByTagName('form')[0];\n        const inputs = responseForm.getElementsByTagName('input');\n        const values = {};\n        for (let i = 0; inputs[i]; i++) {\n            const input = inputs[i];\n            const name = input.getAttribute('name');\n            const value = input.getAttribute('value');\n            if (name && name !== '{}' && value && value !== '') {\n                values[name] = value;\n            }\n        }\n        return values;\n    }\n    convertToMap(paramList) {\n        return paramList.reduce(function (result, item) {\n            const key = item.key;\n            result[key] = item.value;\n            return result;\n        }, {});\n    }\n}\nOccCheckoutPaymentAdapter.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutPaymentAdapter, deps: [{ token: i1.HttpClient }, { token: i2.OccEndpointsService }, { token: i2.ConverterService }], target: i0.ɵɵFactoryTarget.Injectable });\nOccCheckoutPaymentAdapter.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutPaymentAdapter });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutPaymentAdapter, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: i1.HttpClient }, { type: i2.OccEndpointsService }, { type: i2.ConverterService }]; } });\n\nclass OccCheckoutReplenishmentOrderAdapter {\n    constructor(http, occEndpoints, converter) {\n        this.http = http;\n        this.occEndpoints = occEndpoints;\n        this.converter = converter;\n    }\n    getScheduleReplenishmentOrderEndpoint(userId, cartId, termsChecked) {\n        return this.occEndpoints.buildUrl('scheduleReplenishmentOrder', {\n            urlParams: {\n                userId,\n            },\n            queryParams: { cartId, termsChecked },\n        });\n    }\n    scheduleReplenishmentOrder(cartId, scheduleReplenishmentForm, termsChecked, userId) {\n        scheduleReplenishmentForm = this.converter.convert(scheduleReplenishmentForm, REPLENISHMENT_ORDER_FORM_SERIALIZER);\n        const headers = new HttpHeaders().set('Content-Type', 'application/json');\n        return this.http\n            .post(this.getScheduleReplenishmentOrderEndpoint(userId, cartId, termsChecked.toString()), scheduleReplenishmentForm, { headers })\n            .pipe(this.converter.pipeable(REPLENISHMENT_ORDER_NORMALIZER));\n    }\n}\nOccCheckoutReplenishmentOrderAdapter.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutReplenishmentOrderAdapter, deps: [{ token: i1.HttpClient }, { token: i2.OccEndpointsService }, { token: i2.ConverterService }], target: i0.ɵɵFactoryTarget.Injectable });\nOccCheckoutReplenishmentOrderAdapter.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutReplenishmentOrderAdapter });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutReplenishmentOrderAdapter, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: i1.HttpClient }, { type: i2.OccEndpointsService }, { type: i2.ConverterService }]; } });\n\nclass OccCheckoutAdapter {\n    constructor(http, occEndpoints, converter) {\n        this.http = http;\n        this.occEndpoints = occEndpoints;\n        this.converter = converter;\n    }\n    getPlaceOrderEndpoint(userId, cartId, termsChecked) {\n        return this.occEndpoints.buildUrl('placeOrder', {\n            urlParams: { userId },\n            queryParams: { cartId, termsChecked },\n        });\n    }\n    getRemoveDeliveryAddressEndpoint(userId, cartId) {\n        return this.occEndpoints.buildUrl('removeDeliveryAddress', {\n            urlParams: {\n                userId,\n                cartId,\n            },\n        });\n    }\n    getClearDeliveryModeEndpoint(userId, cartId) {\n        return this.occEndpoints.buildUrl('clearDeliveryMode', {\n            urlParams: { userId, cartId },\n        });\n    }\n    getLoadCheckoutDetailsEndpoint(userId, cartId) {\n        return this.occEndpoints.buildUrl('loadCheckoutDetails', {\n            urlParams: {\n                userId,\n                cartId,\n            },\n        });\n    }\n    placeOrder(userId, cartId, termsChecked) {\n        let headers = new HttpHeaders({\n            'Content-Type': 'application/x-www-form-urlencoded',\n        });\n        if (userId === OCC_USER_ID_ANONYMOUS) {\n            headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n        }\n        return this.http\n            .post(this.getPlaceOrderEndpoint(userId, cartId, termsChecked.toString()), {}, { headers })\n            .pipe(this.converter.pipeable(ORDER_NORMALIZER));\n    }\n    loadCheckoutDetails(userId, cartId) {\n        return this.http.get(this.getLoadCheckoutDetailsEndpoint(userId, cartId));\n    }\n    clearCheckoutDeliveryAddress(userId, cartId) {\n        return this.http.delete(this.getRemoveDeliveryAddressEndpoint(userId, cartId));\n    }\n    clearCheckoutDeliveryMode(userId, cartId) {\n        return this.http.delete(this.getClearDeliveryModeEndpoint(userId, cartId));\n    }\n}\nOccCheckoutAdapter.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutAdapter, deps: [{ token: i1.HttpClient }, { token: i2.OccEndpointsService }, { token: i2.ConverterService }], target: i0.ɵɵFactoryTarget.Injectable });\nOccCheckoutAdapter.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutAdapter });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccCheckoutAdapter, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: i1.HttpClient }, { type: i2.OccEndpointsService }, { type: i2.ConverterService }]; } });\n\nconst defaultOccCheckoutConfig = {\n    backend: {\n        occ: {\n            endpoints: {\n                /* eslint-disable max-len */\n                setDeliveryAddress: 'users/${userId}/carts/${cartId}/addresses/delivery',\n                placeOrder: 'users/${userId}/orders?fields=FULL',\n                cardTypes: 'cardtypes',\n                paymentTypes: 'paymenttypes',\n                createDeliveryAddress: 'users/${userId}/carts/${cartId}/addresses/delivery',\n                removeDeliveryAddress: 'users/${userId}/carts/${cartId}/addresses/delivery',\n                deliveryMode: 'users/${userId}/carts/${cartId}/deliverymode',\n                setDeliveryMode: 'users/${userId}/carts/${cartId}/deliverymode',\n                clearDeliveryMode: 'users/${userId}/carts/${cartId}/deliverymode',\n                deliveryModes: 'users/${userId}/carts/${cartId}/deliverymodes',\n                setCartCostCenter: 'users/${userId}/carts/${cartId}/costcenter?fields=DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),user',\n                setCartPaymentType: 'users/${userId}/carts/${cartId}/paymenttype?fields=DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),user',\n                setCartPaymentDetails: 'users/${userId}/carts/${cartId}/paymentdetails',\n                paymentProviderSubInfo: 'users/${userId}/carts/${cartId}/payment/sop/request?responseUrl=sampleUrl',\n                createPaymentDetails: 'users/${userId}/carts/${cartId}/payment/sop/response',\n                loadCheckoutDetails: 'users/${userId}/carts/${cartId}?fields=deliveryAddress(FULL),deliveryMode,paymentInfo(FULL)',\n                /* eslint-enable */\n            },\n        },\n    },\n};\n\nclass CheckoutOccModule {\n}\nCheckoutOccModule.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: CheckoutOccModule, deps: [], target: i0.ɵɵFactoryTarget.NgModule });\nCheckoutOccModule.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: CheckoutOccModule, imports: [CommonModule] });\nCheckoutOccModule.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: CheckoutOccModule, providers: [\n        provideDefaultConfig(defaultOccCheckoutConfig),\n        OccReplenishmentOrderFormSerializer,\n        {\n            provide: CheckoutAdapter,\n            useClass: OccCheckoutAdapter,\n        },\n        {\n            provide: CheckoutDeliveryAdapter,\n            useClass: OccCheckoutDeliveryAdapter,\n        },\n        {\n            provide: CheckoutPaymentAdapter,\n            useClass: OccCheckoutPaymentAdapter,\n        },\n        {\n            provide: PaymentTypeAdapter,\n            useClass: OccCheckoutPaymentTypeAdapter,\n        },\n        {\n            provide: CheckoutCostCenterAdapter,\n            useClass: OccCheckoutCostCenterAdapter,\n        },\n        {\n            provide: CheckoutReplenishmentOrderAdapter,\n            useClass: OccCheckoutReplenishmentOrderAdapter,\n        },\n        {\n            provide: REPLENISHMENT_ORDER_FORM_SERIALIZER,\n            useExisting: OccReplenishmentOrderFormSerializer,\n            multi: true,\n        },\n    ], imports: [[CommonModule]] });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: CheckoutOccModule, decorators: [{\n            type: NgModule,\n            args: [{\n                    imports: [CommonModule],\n                    providers: [\n                        provideDefaultConfig(defaultOccCheckoutConfig),\n                        OccReplenishmentOrderFormSerializer,\n                        {\n                            provide: CheckoutAdapter,\n                            useClass: OccCheckoutAdapter,\n                        },\n                        {\n                            provide: CheckoutDeliveryAdapter,\n                            useClass: OccCheckoutDeliveryAdapter,\n                        },\n                        {\n                            provide: CheckoutPaymentAdapter,\n                            useClass: OccCheckoutPaymentAdapter,\n                        },\n                        {\n                            provide: PaymentTypeAdapter,\n                            useClass: OccCheckoutPaymentTypeAdapter,\n                        },\n                        {\n                            provide: CheckoutCostCenterAdapter,\n                            useClass: OccCheckoutCostCenterAdapter,\n                        },\n                        {\n                            provide: CheckoutReplenishmentOrderAdapter,\n                            useClass: OccCheckoutReplenishmentOrderAdapter,\n                        },\n                        {\n                            provide: REPLENISHMENT_ORDER_FORM_SERIALIZER,\n                            useExisting: OccReplenishmentOrderFormSerializer,\n                            multi: true,\n                        },\n                    ],\n                }]\n        }] });\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { CheckoutOccModule, OccCheckoutAdapter, OccCheckoutCostCenterAdapter, OccCheckoutDeliveryAdapter, OccCheckoutPaymentAdapter, OccCheckoutPaymentTypeAdapter, OccCheckoutReplenishmentOrderAdapter, OccReplenishmentOrderFormSerializer };\n//# sourceMappingURL=spartacus-checkout-occ.js.map\n"]},"metadata":{},"sourceType":"module"}