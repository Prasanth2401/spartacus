{"ast":null,"code":"import * as i1 from '@angular/common/http';\nimport { HttpHeaders, HttpParams } from '@angular/common/http';\nimport * as i0 from '@angular/core';\nimport { Injectable, NgModule } from '@angular/core';\nimport * as i2 from '@spartacus/core';\nimport { normalizeHttpError, InterceptorUtil, USE_CLIENT_TOKEN, provideDefaultConfig } from '@spartacus/core';\nimport { USER_PROFILE_SERIALIZER, USER_SIGN_UP_SERIALIZER, USER_PROFILE_NORMALIZER, TITLE_NORMALIZER, UserProfileAdapter } from '@spartacus/user/profile/core';\nimport { throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nconst defaultOccUserProfileConfig = {\n  backend: {\n    occ: {\n      endpoints: {\n        userRegister: 'users',\n        userForgotPassword: 'forgottenpasswordtokens',\n        userResetPassword: 'resetpassword',\n        userUpdateLoginId: 'users/${userId}/login',\n        userUpdatePassword: 'users/${userId}/password',\n        titles: 'titles'\n      }\n    }\n  }\n};\n\nclass OccUserProfileAdapter {\n  constructor(http, occEndpoints, converter) {\n    this.http = http;\n    this.occEndpoints = occEndpoints;\n    this.converter = converter;\n  }\n\n  update(userId, user) {\n    const endpoint = this.occEndpoints.isConfigured('userUpdateProfile') ? 'userUpdateProfile' : 'user';\n    const url = this.occEndpoints.buildUrl(endpoint, {\n      urlParams: {\n        userId\n      }\n    });\n    user = this.converter.convert(user, USER_PROFILE_SERIALIZER);\n    return this.http.patch(url, user).pipe(catchError(error => throwError(normalizeHttpError(error))));\n  }\n\n  register(user) {\n    const url = this.occEndpoints.buildUrl('userRegister');\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/json'\n    });\n    headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    user = this.converter.convert(user, USER_SIGN_UP_SERIALIZER);\n    return this.http.post(url, user, {\n      headers\n    }).pipe(catchError(error => throwError(normalizeHttpError(error))), this.converter.pipeable(USER_PROFILE_NORMALIZER));\n  }\n\n  registerGuest(guid, password) {\n    const url = this.occEndpoints.buildUrl('userRegister');\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded'\n    });\n    headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    const httpParams = new HttpParams().set('guid', guid).set('password', password);\n    return this.http.post(url, httpParams, {\n      headers\n    }).pipe(catchError(error => throwError(normalizeHttpError(error))), this.converter.pipeable(USER_PROFILE_NORMALIZER));\n  }\n\n  requestForgotPasswordEmail(userEmailAddress) {\n    const url = this.occEndpoints.buildUrl('userForgotPassword');\n    const httpParams = new HttpParams().set('userId', userEmailAddress);\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded'\n    });\n    headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    return this.http.post(url, httpParams, {\n      headers\n    }).pipe(catchError(error => throwError(normalizeHttpError(error))));\n  }\n\n  resetPassword(token, newPassword) {\n    const url = this.occEndpoints.buildUrl('userResetPassword');\n    let headers = new HttpHeaders({\n      'Content-Type': 'application/json'\n    });\n    headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n    return this.http.post(url, {\n      token,\n      newPassword\n    }, {\n      headers\n    }).pipe(catchError(error => throwError(normalizeHttpError(error))));\n  }\n\n  updateEmail(userId, currentPassword, newUserId) {\n    const url = this.occEndpoints.buildUrl('userUpdateLoginId', {\n      urlParams: {\n        userId\n      }\n    });\n    const httpParams = new HttpParams().set('password', currentPassword).set('newLogin', newUserId);\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded'\n    });\n    return this.http.put(url, httpParams, {\n      headers\n    }).pipe(catchError(error => throwError(normalizeHttpError(error))));\n  }\n\n  updatePassword(userId, oldPassword, newPassword) {\n    const url = this.occEndpoints.buildUrl('userUpdatePassword', {\n      urlParams: {\n        userId\n      }\n    });\n    const httpParams = new HttpParams().set('old', oldPassword).set('new', newPassword);\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded'\n    });\n    return this.http.put(url, httpParams, {\n      headers\n    }).pipe(catchError(error => throwError(normalizeHttpError(error))));\n  }\n\n  close(userId) {\n    const endpoint = this.occEndpoints.isConfigured('userCloseAccount') ? 'userCloseAccount' : 'user';\n    const url = this.occEndpoints.buildUrl(endpoint, {\n      urlParams: {\n        userId\n      }\n    });\n    return this.http.delete(url).pipe(catchError(error => throwError(normalizeHttpError(error))));\n  }\n\n  loadTitles() {\n    const url = this.occEndpoints.buildUrl('titles');\n    return this.http.get(url).pipe(catchError(error => throwError(normalizeHttpError(error))), map(titleList => {\n      var _a;\n\n      return (_a = titleList.titles) !== null && _a !== void 0 ? _a : [];\n    }), this.converter.pipeableMany(TITLE_NORMALIZER));\n  }\n\n}\n\nOccUserProfileAdapter.ɵfac = function OccUserProfileAdapter_Factory(t) {\n  return new (t || OccUserProfileAdapter)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.OccEndpointsService), i0.ɵɵinject(i2.ConverterService));\n};\n\nOccUserProfileAdapter.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: OccUserProfileAdapter,\n  factory: OccUserProfileAdapter.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(OccUserProfileAdapter, [{\n    type: Injectable\n  }], function () {\n    return [{\n      type: i1.HttpClient\n    }, {\n      type: i2.OccEndpointsService\n    }, {\n      type: i2.ConverterService\n    }];\n  }, null);\n})();\n\nclass UserProfileOccModule {}\n\nUserProfileOccModule.ɵfac = function UserProfileOccModule_Factory(t) {\n  return new (t || UserProfileOccModule)();\n};\n\nUserProfileOccModule.ɵmod = /* @__PURE__ */i0.ɵɵdefineNgModule({\n  type: UserProfileOccModule\n});\nUserProfileOccModule.ɵinj = /* @__PURE__ */i0.ɵɵdefineInjector({\n  providers: [provideDefaultConfig(defaultOccUserProfileConfig), {\n    provide: UserProfileAdapter,\n    useClass: OccUserProfileAdapter\n  }]\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(UserProfileOccModule, [{\n    type: NgModule,\n    args: [{\n      providers: [provideDefaultConfig(defaultOccUserProfileConfig), {\n        provide: UserProfileAdapter,\n        useClass: OccUserProfileAdapter\n      }]\n    }]\n  }], null, null);\n})();\n/**\n * Generated bundle index. Do not edit.\n */\n\n\nexport { OccUserProfileAdapter, UserProfileOccModule, defaultOccUserProfileConfig }; //# sourceMappingURL=spartacus-user-profile-occ.js.map","map":{"version":3,"sources":["D:/spartacus/front-store/node_modules/@spartacus/user/fesm2015/spartacus-user-profile-occ.js"],"names":["i1","HttpHeaders","HttpParams","i0","Injectable","NgModule","i2","normalizeHttpError","InterceptorUtil","USE_CLIENT_TOKEN","provideDefaultConfig","USER_PROFILE_SERIALIZER","USER_SIGN_UP_SERIALIZER","USER_PROFILE_NORMALIZER","TITLE_NORMALIZER","UserProfileAdapter","throwError","catchError","map","defaultOccUserProfileConfig","backend","occ","endpoints","userRegister","userForgotPassword","userResetPassword","userUpdateLoginId","userUpdatePassword","titles","OccUserProfileAdapter","constructor","http","occEndpoints","converter","update","userId","user","endpoint","isConfigured","url","buildUrl","urlParams","convert","patch","pipe","error","register","headers","createHeader","post","pipeable","registerGuest","guid","password","httpParams","set","requestForgotPasswordEmail","userEmailAddress","resetPassword","token","newPassword","updateEmail","currentPassword","newUserId","put","updatePassword","oldPassword","close","delete","loadTitles","get","titleList","_a","pipeableMany","ɵfac","HttpClient","OccEndpointsService","ConverterService","ɵprov","type","UserProfileOccModule","ɵmod","ɵinj","provide","useClass","args","providers"],"mappings":"AAAA,OAAO,KAAKA,EAAZ,MAAoB,sBAApB;AACA,SAASC,WAAT,EAAsBC,UAAtB,QAAwC,sBAAxC;AACA,OAAO,KAAKC,EAAZ,MAAoB,eAApB;AACA,SAASC,UAAT,EAAqBC,QAArB,QAAqC,eAArC;AACA,OAAO,KAAKC,EAAZ,MAAoB,iBAApB;AACA,SAASC,kBAAT,EAA6BC,eAA7B,EAA8CC,gBAA9C,EAAgEC,oBAAhE,QAA4F,iBAA5F;AACA,SAASC,uBAAT,EAAkCC,uBAAlC,EAA2DC,uBAA3D,EAAoFC,gBAApF,EAAsGC,kBAAtG,QAAgI,8BAAhI;AACA,SAASC,UAAT,QAA2B,MAA3B;AACA,SAASC,UAAT,EAAqBC,GAArB,QAAgC,gBAAhC;AAEA,MAAMC,2BAA2B,GAAG;AAChCC,EAAAA,OAAO,EAAE;AACLC,IAAAA,GAAG,EAAE;AACDC,MAAAA,SAAS,EAAE;AACPC,QAAAA,YAAY,EAAE,OADP;AAEPC,QAAAA,kBAAkB,EAAE,yBAFb;AAGPC,QAAAA,iBAAiB,EAAE,eAHZ;AAIPC,QAAAA,iBAAiB,EAAE,uBAJZ;AAKPC,QAAAA,kBAAkB,EAAE,0BALb;AAMPC,QAAAA,MAAM,EAAE;AAND;AADV;AADA;AADuB,CAApC;;AAeA,MAAMC,qBAAN,CAA4B;AACxBC,EAAAA,WAAW,CAACC,IAAD,EAAOC,YAAP,EAAqBC,SAArB,EAAgC;AACvC,SAAKF,IAAL,GAAYA,IAAZ;AACA,SAAKC,YAAL,GAAoBA,YAApB;AACA,SAAKC,SAAL,GAAiBA,SAAjB;AACH;;AACDC,EAAAA,MAAM,CAACC,MAAD,EAASC,IAAT,EAAe;AACjB,UAAMC,QAAQ,GAAG,KAAKL,YAAL,CAAkBM,YAAlB,CAA+B,mBAA/B,IACX,mBADW,GAEX,MAFN;AAGA,UAAMC,GAAG,GAAG,KAAKP,YAAL,CAAkBQ,QAAlB,CAA2BH,QAA3B,EAAqC;AAAEI,MAAAA,SAAS,EAAE;AAAEN,QAAAA;AAAF;AAAb,KAArC,CAAZ;AACAC,IAAAA,IAAI,GAAG,KAAKH,SAAL,CAAeS,OAAf,CAAuBN,IAAvB,EAA6BzB,uBAA7B,CAAP;AACA,WAAO,KAAKoB,IAAL,CACFY,KADE,CACIJ,GADJ,EACSH,IADT,EAEFQ,IAFE,CAEG3B,UAAU,CAAE4B,KAAD,IAAW7B,UAAU,CAACT,kBAAkB,CAACsC,KAAD,CAAnB,CAAtB,CAFb,CAAP;AAGH;;AACDC,EAAAA,QAAQ,CAACV,IAAD,EAAO;AACX,UAAMG,GAAG,GAAG,KAAKP,YAAL,CAAkBQ,QAAlB,CAA2B,cAA3B,CAAZ;AACA,QAAIO,OAAO,GAAG,IAAI9C,WAAJ,CAAgB;AAC1B,sBAAgB;AADU,KAAhB,CAAd;AAGA8C,IAAAA,OAAO,GAAGvC,eAAe,CAACwC,YAAhB,CAA6BvC,gBAA7B,EAA+C,IAA/C,EAAqDsC,OAArD,CAAV;AACAX,IAAAA,IAAI,GAAG,KAAKH,SAAL,CAAeS,OAAf,CAAuBN,IAAvB,EAA6BxB,uBAA7B,CAAP;AACA,WAAO,KAAKmB,IAAL,CAAUkB,IAAV,CAAeV,GAAf,EAAoBH,IAApB,EAA0B;AAAEW,MAAAA;AAAF,KAA1B,EAAuCH,IAAvC,CAA4C3B,UAAU,CAAE4B,KAAD,IAAW7B,UAAU,CAACT,kBAAkB,CAACsC,KAAD,CAAnB,CAAtB,CAAtD,EAA0G,KAAKZ,SAAL,CAAeiB,QAAf,CAAwBrC,uBAAxB,CAA1G,CAAP;AACH;;AACDsC,EAAAA,aAAa,CAACC,IAAD,EAAOC,QAAP,EAAiB;AAC1B,UAAMd,GAAG,GAAG,KAAKP,YAAL,CAAkBQ,QAAlB,CAA2B,cAA3B,CAAZ;AACA,QAAIO,OAAO,GAAG,IAAI9C,WAAJ,CAAgB;AAC1B,sBAAgB;AADU,KAAhB,CAAd;AAGA8C,IAAAA,OAAO,GAAGvC,eAAe,CAACwC,YAAhB,CAA6BvC,gBAA7B,EAA+C,IAA/C,EAAqDsC,OAArD,CAAV;AACA,UAAMO,UAAU,GAAG,IAAIpD,UAAJ,GACdqD,GADc,CACV,MADU,EACFH,IADE,EAEdG,GAFc,CAEV,UAFU,EAEEF,QAFF,CAAnB;AAGA,WAAO,KAAKtB,IAAL,CAAUkB,IAAV,CAAeV,GAAf,EAAoBe,UAApB,EAAgC;AAAEP,MAAAA;AAAF,KAAhC,EAA6CH,IAA7C,CAAkD3B,UAAU,CAAE4B,KAAD,IAAW7B,UAAU,CAACT,kBAAkB,CAACsC,KAAD,CAAnB,CAAtB,CAA5D,EAAgH,KAAKZ,SAAL,CAAeiB,QAAf,CAAwBrC,uBAAxB,CAAhH,CAAP;AACH;;AACD2C,EAAAA,0BAA0B,CAACC,gBAAD,EAAmB;AACzC,UAAMlB,GAAG,GAAG,KAAKP,YAAL,CAAkBQ,QAAlB,CAA2B,oBAA3B,CAAZ;AACA,UAAMc,UAAU,GAAG,IAAIpD,UAAJ,GAAiBqD,GAAjB,CAAqB,QAArB,EAA+BE,gBAA/B,CAAnB;AACA,QAAIV,OAAO,GAAG,IAAI9C,WAAJ,CAAgB;AAC1B,sBAAgB;AADU,KAAhB,CAAd;AAGA8C,IAAAA,OAAO,GAAGvC,eAAe,CAACwC,YAAhB,CAA6BvC,gBAA7B,EAA+C,IAA/C,EAAqDsC,OAArD,CAAV;AACA,WAAO,KAAKhB,IAAL,CACFkB,IADE,CACGV,GADH,EACQe,UADR,EACoB;AAAEP,MAAAA;AAAF,KADpB,EAEFH,IAFE,CAEG3B,UAAU,CAAE4B,KAAD,IAAW7B,UAAU,CAACT,kBAAkB,CAACsC,KAAD,CAAnB,CAAtB,CAFb,CAAP;AAGH;;AACDa,EAAAA,aAAa,CAACC,KAAD,EAAQC,WAAR,EAAqB;AAC9B,UAAMrB,GAAG,GAAG,KAAKP,YAAL,CAAkBQ,QAAlB,CAA2B,mBAA3B,CAAZ;AACA,QAAIO,OAAO,GAAG,IAAI9C,WAAJ,CAAgB;AAC1B,sBAAgB;AADU,KAAhB,CAAd;AAGA8C,IAAAA,OAAO,GAAGvC,eAAe,CAACwC,YAAhB,CAA6BvC,gBAA7B,EAA+C,IAA/C,EAAqDsC,OAArD,CAAV;AACA,WAAO,KAAKhB,IAAL,CACFkB,IADE,CACGV,GADH,EACQ;AAAEoB,MAAAA,KAAF;AAASC,MAAAA;AAAT,KADR,EACgC;AAAEb,MAAAA;AAAF,KADhC,EAEFH,IAFE,CAEG3B,UAAU,CAAE4B,KAAD,IAAW7B,UAAU,CAACT,kBAAkB,CAACsC,KAAD,CAAnB,CAAtB,CAFb,CAAP;AAGH;;AACDgB,EAAAA,WAAW,CAAC1B,MAAD,EAAS2B,eAAT,EAA0BC,SAA1B,EAAqC;AAC5C,UAAMxB,GAAG,GAAG,KAAKP,YAAL,CAAkBQ,QAAlB,CAA2B,mBAA3B,EAAgD;AACxDC,MAAAA,SAAS,EAAE;AAAEN,QAAAA;AAAF;AAD6C,KAAhD,CAAZ;AAGA,UAAMmB,UAAU,GAAG,IAAIpD,UAAJ,GACdqD,GADc,CACV,UADU,EACEO,eADF,EAEdP,GAFc,CAEV,UAFU,EAEEQ,SAFF,CAAnB;AAGA,UAAMhB,OAAO,GAAG,IAAI9C,WAAJ,CAAgB;AAC5B,sBAAgB;AADY,KAAhB,CAAhB;AAGA,WAAO,KAAK8B,IAAL,CACFiC,GADE,CACEzB,GADF,EACOe,UADP,EACmB;AAAEP,MAAAA;AAAF,KADnB,EAEFH,IAFE,CAEG3B,UAAU,CAAE4B,KAAD,IAAW7B,UAAU,CAACT,kBAAkB,CAACsC,KAAD,CAAnB,CAAtB,CAFb,CAAP;AAGH;;AACDoB,EAAAA,cAAc,CAAC9B,MAAD,EAAS+B,WAAT,EAAsBN,WAAtB,EAAmC;AAC7C,UAAMrB,GAAG,GAAG,KAAKP,YAAL,CAAkBQ,QAAlB,CAA2B,oBAA3B,EAAiD;AACzDC,MAAAA,SAAS,EAAE;AAAEN,QAAAA;AAAF;AAD8C,KAAjD,CAAZ;AAGA,UAAMmB,UAAU,GAAG,IAAIpD,UAAJ,GACdqD,GADc,CACV,KADU,EACHW,WADG,EAEdX,GAFc,CAEV,KAFU,EAEHK,WAFG,CAAnB;AAGA,UAAMb,OAAO,GAAG,IAAI9C,WAAJ,CAAgB;AAC5B,sBAAgB;AADY,KAAhB,CAAhB;AAGA,WAAO,KAAK8B,IAAL,CACFiC,GADE,CACEzB,GADF,EACOe,UADP,EACmB;AAAEP,MAAAA;AAAF,KADnB,EAEFH,IAFE,CAEG3B,UAAU,CAAE4B,KAAD,IAAW7B,UAAU,CAACT,kBAAkB,CAACsC,KAAD,CAAnB,CAAtB,CAFb,CAAP;AAGH;;AACDsB,EAAAA,KAAK,CAAChC,MAAD,EAAS;AACV,UAAME,QAAQ,GAAG,KAAKL,YAAL,CAAkBM,YAAlB,CAA+B,kBAA/B,IACX,kBADW,GAEX,MAFN;AAGA,UAAMC,GAAG,GAAG,KAAKP,YAAL,CAAkBQ,QAAlB,CAA2BH,QAA3B,EAAqC;AAAEI,MAAAA,SAAS,EAAE;AAAEN,QAAAA;AAAF;AAAb,KAArC,CAAZ;AACA,WAAO,KAAKJ,IAAL,CACFqC,MADE,CACK7B,GADL,EAEFK,IAFE,CAEG3B,UAAU,CAAE4B,KAAD,IAAW7B,UAAU,CAACT,kBAAkB,CAACsC,KAAD,CAAnB,CAAtB,CAFb,CAAP;AAGH;;AACDwB,EAAAA,UAAU,GAAG;AACT,UAAM9B,GAAG,GAAG,KAAKP,YAAL,CAAkBQ,QAAlB,CAA2B,QAA3B,CAAZ;AACA,WAAO,KAAKT,IAAL,CAAUuC,GAAV,CAAc/B,GAAd,EAAmBK,IAAnB,CAAwB3B,UAAU,CAAE4B,KAAD,IAAW7B,UAAU,CAACT,kBAAkB,CAACsC,KAAD,CAAnB,CAAtB,CAAlC,EAAsF3B,GAAG,CAAEqD,SAAD,IAAe;AAAE,UAAIC,EAAJ;;AAAQ,aAAO,CAACA,EAAE,GAAGD,SAAS,CAAC3C,MAAhB,MAA4B,IAA5B,IAAoC4C,EAAE,KAAK,KAAK,CAAhD,GAAoDA,EAApD,GAAyD,EAAhE;AAAqE,KAA/F,CAAzF,EAA2L,KAAKvC,SAAL,CAAewC,YAAf,CAA4B3D,gBAA5B,CAA3L,CAAP;AACH;;AAjGuB;;AAmG5Be,qBAAqB,CAAC6C,IAAtB;AAAA,mBAAkH7C,qBAAlH,EAAwG1B,EAAxG,UAAyJH,EAAE,CAAC2E,UAA5J,GAAwGxE,EAAxG,UAAmLG,EAAE,CAACsE,mBAAtL,GAAwGzE,EAAxG,UAAsNG,EAAE,CAACuE,gBAAzN;AAAA;;AACAhD,qBAAqB,CAACiD,KAAtB,kBADwG3E,EACxG;AAAA,SAAsH0B,qBAAtH;AAAA,WAAsHA,qBAAtH;AAAA;;AACA;AAAA,qDAFwG1B,EAExG,mBAA2F0B,qBAA3F,EAA8H,CAAC;AACnHkD,IAAAA,IAAI,EAAE3E;AAD6G,GAAD,CAA9H,EAE4B,YAAY;AAAE,WAAO,CAAC;AAAE2E,MAAAA,IAAI,EAAE/E,EAAE,CAAC2E;AAAX,KAAD,EAA0B;AAAEI,MAAAA,IAAI,EAAEzE,EAAE,CAACsE;AAAX,KAA1B,EAA4D;AAAEG,MAAAA,IAAI,EAAEzE,EAAE,CAACuE;AAAX,KAA5D,CAAP;AAAoG,GAF9I;AAAA;;AAIA,MAAMG,oBAAN,CAA2B;;AAE3BA,oBAAoB,CAACN,IAArB;AAAA,mBAAiHM,oBAAjH;AAAA;;AACAA,oBAAoB,CAACC,IAArB,kBATwG9E,EASxG;AAAA,QAAkH6E;AAAlH;AACAA,oBAAoB,CAACE,IAArB,kBAVwG/E,EAUxG;AAAA,aAAmJ,CAC3IO,oBAAoB,CAACS,2BAAD,CADuH,EAE3I;AAAEgE,IAAAA,OAAO,EAAEpE,kBAAX;AAA+BqE,IAAAA,QAAQ,EAAEvD;AAAzC,GAF2I;AAAnJ;;AAIA;AAAA,qDAdwG1B,EAcxG,mBAA2F6E,oBAA3F,EAA6H,CAAC;AAClHD,IAAAA,IAAI,EAAE1E,QAD4G;AAElHgF,IAAAA,IAAI,EAAE,CAAC;AACCC,MAAAA,SAAS,EAAE,CACP5E,oBAAoB,CAACS,2BAAD,CADb,EAEP;AAAEgE,QAAAA,OAAO,EAAEpE,kBAAX;AAA+BqE,QAAAA,QAAQ,EAAEvD;AAAzC,OAFO;AADZ,KAAD;AAF4G,GAAD,CAA7H;AAAA;AAUA;AACA;AACA;;;AAEA,SAASA,qBAAT,EAAgCmD,oBAAhC,EAAsD7D,2BAAtD,G,CACA","sourcesContent":["import * as i1 from '@angular/common/http';\nimport { HttpHeaders, HttpParams } from '@angular/common/http';\nimport * as i0 from '@angular/core';\nimport { Injectable, NgModule } from '@angular/core';\nimport * as i2 from '@spartacus/core';\nimport { normalizeHttpError, InterceptorUtil, USE_CLIENT_TOKEN, provideDefaultConfig } from '@spartacus/core';\nimport { USER_PROFILE_SERIALIZER, USER_SIGN_UP_SERIALIZER, USER_PROFILE_NORMALIZER, TITLE_NORMALIZER, UserProfileAdapter } from '@spartacus/user/profile/core';\nimport { throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\n\nconst defaultOccUserProfileConfig = {\n    backend: {\n        occ: {\n            endpoints: {\n                userRegister: 'users',\n                userForgotPassword: 'forgottenpasswordtokens',\n                userResetPassword: 'resetpassword',\n                userUpdateLoginId: 'users/${userId}/login',\n                userUpdatePassword: 'users/${userId}/password',\n                titles: 'titles',\n            },\n        },\n    },\n};\n\nclass OccUserProfileAdapter {\n    constructor(http, occEndpoints, converter) {\n        this.http = http;\n        this.occEndpoints = occEndpoints;\n        this.converter = converter;\n    }\n    update(userId, user) {\n        const endpoint = this.occEndpoints.isConfigured('userUpdateProfile')\n            ? 'userUpdateProfile'\n            : 'user';\n        const url = this.occEndpoints.buildUrl(endpoint, { urlParams: { userId } });\n        user = this.converter.convert(user, USER_PROFILE_SERIALIZER);\n        return this.http\n            .patch(url, user)\n            .pipe(catchError((error) => throwError(normalizeHttpError(error))));\n    }\n    register(user) {\n        const url = this.occEndpoints.buildUrl('userRegister');\n        let headers = new HttpHeaders({\n            'Content-Type': 'application/json',\n        });\n        headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n        user = this.converter.convert(user, USER_SIGN_UP_SERIALIZER);\n        return this.http.post(url, user, { headers }).pipe(catchError((error) => throwError(normalizeHttpError(error))), this.converter.pipeable(USER_PROFILE_NORMALIZER));\n    }\n    registerGuest(guid, password) {\n        const url = this.occEndpoints.buildUrl('userRegister');\n        let headers = new HttpHeaders({\n            'Content-Type': 'application/x-www-form-urlencoded',\n        });\n        headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n        const httpParams = new HttpParams()\n            .set('guid', guid)\n            .set('password', password);\n        return this.http.post(url, httpParams, { headers }).pipe(catchError((error) => throwError(normalizeHttpError(error))), this.converter.pipeable(USER_PROFILE_NORMALIZER));\n    }\n    requestForgotPasswordEmail(userEmailAddress) {\n        const url = this.occEndpoints.buildUrl('userForgotPassword');\n        const httpParams = new HttpParams().set('userId', userEmailAddress);\n        let headers = new HttpHeaders({\n            'Content-Type': 'application/x-www-form-urlencoded',\n        });\n        headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n        return this.http\n            .post(url, httpParams, { headers })\n            .pipe(catchError((error) => throwError(normalizeHttpError(error))));\n    }\n    resetPassword(token, newPassword) {\n        const url = this.occEndpoints.buildUrl('userResetPassword');\n        let headers = new HttpHeaders({\n            'Content-Type': 'application/json',\n        });\n        headers = InterceptorUtil.createHeader(USE_CLIENT_TOKEN, true, headers);\n        return this.http\n            .post(url, { token, newPassword }, { headers })\n            .pipe(catchError((error) => throwError(normalizeHttpError(error))));\n    }\n    updateEmail(userId, currentPassword, newUserId) {\n        const url = this.occEndpoints.buildUrl('userUpdateLoginId', {\n            urlParams: { userId },\n        });\n        const httpParams = new HttpParams()\n            .set('password', currentPassword)\n            .set('newLogin', newUserId);\n        const headers = new HttpHeaders({\n            'Content-Type': 'application/x-www-form-urlencoded',\n        });\n        return this.http\n            .put(url, httpParams, { headers })\n            .pipe(catchError((error) => throwError(normalizeHttpError(error))));\n    }\n    updatePassword(userId, oldPassword, newPassword) {\n        const url = this.occEndpoints.buildUrl('userUpdatePassword', {\n            urlParams: { userId },\n        });\n        const httpParams = new HttpParams()\n            .set('old', oldPassword)\n            .set('new', newPassword);\n        const headers = new HttpHeaders({\n            'Content-Type': 'application/x-www-form-urlencoded',\n        });\n        return this.http\n            .put(url, httpParams, { headers })\n            .pipe(catchError((error) => throwError(normalizeHttpError(error))));\n    }\n    close(userId) {\n        const endpoint = this.occEndpoints.isConfigured('userCloseAccount')\n            ? 'userCloseAccount'\n            : 'user';\n        const url = this.occEndpoints.buildUrl(endpoint, { urlParams: { userId } });\n        return this.http\n            .delete(url)\n            .pipe(catchError((error) => throwError(normalizeHttpError(error))));\n    }\n    loadTitles() {\n        const url = this.occEndpoints.buildUrl('titles');\n        return this.http.get(url).pipe(catchError((error) => throwError(normalizeHttpError(error))), map((titleList) => { var _a; return (_a = titleList.titles) !== null && _a !== void 0 ? _a : []; }), this.converter.pipeableMany(TITLE_NORMALIZER));\n    }\n}\nOccUserProfileAdapter.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccUserProfileAdapter, deps: [{ token: i1.HttpClient }, { token: i2.OccEndpointsService }, { token: i2.ConverterService }], target: i0.ɵɵFactoryTarget.Injectable });\nOccUserProfileAdapter.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccUserProfileAdapter });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: OccUserProfileAdapter, decorators: [{\n            type: Injectable\n        }], ctorParameters: function () { return [{ type: i1.HttpClient }, { type: i2.OccEndpointsService }, { type: i2.ConverterService }]; } });\n\nclass UserProfileOccModule {\n}\nUserProfileOccModule.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: UserProfileOccModule, deps: [], target: i0.ɵɵFactoryTarget.NgModule });\nUserProfileOccModule.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: UserProfileOccModule });\nUserProfileOccModule.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: UserProfileOccModule, providers: [\n        provideDefaultConfig(defaultOccUserProfileConfig),\n        { provide: UserProfileAdapter, useClass: OccUserProfileAdapter },\n    ] });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"12.0.5\", ngImport: i0, type: UserProfileOccModule, decorators: [{\n            type: NgModule,\n            args: [{\n                    providers: [\n                        provideDefaultConfig(defaultOccUserProfileConfig),\n                        { provide: UserProfileAdapter, useClass: OccUserProfileAdapter },\n                    ],\n                }]\n        }] });\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { OccUserProfileAdapter, UserProfileOccModule, defaultOccUserProfileConfig };\n//# sourceMappingURL=spartacus-user-profile-occ.js.map\n"]},"metadata":{},"sourceType":"module"}